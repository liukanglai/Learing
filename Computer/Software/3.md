# 第三章 需求分析

软件需求作为软件生命周期的第一个阶段，其重要性越来越突出，到 20 世纪 80 年代中期，逐步形成了软件工程的子领域—需求工程。
90 年代后，需求工程成为软件界研究的重点之一。从 1993 年起，每两年举办一次需求工程国际研讨会（ISRE），1994 年起，每两年举办一次需求工程国际会议（ICRE）。一些关于需求工程的工作小组相继成立，使需求工程的研究得到了迅速进展。

为了开发出真正满足用户需求的软件产品，首先必须知道用户的需求。
对软件需求的深入理解是软件开发工作获得成功的前提条件，不论人们把设计和编码工作做得如何出色，不能真正满足用户需求的程序只会令用户失望，给开发者带来烦恼。
需求分析是软件定义时期的最后一个阶段，它的基本任务是准确地回答“系统必须做什么”这个问题。

尽管目前有许多不同的用于需求分析的结构化分析方法，但是，所有这些分析方法都遵守下述准则。
必须理解并描述问题的信息域，根据这条准则应该建立数据模型。
必须定义软件应完成的功能，这条准则要求建立功能模型。
必须描述作为外部事件结果的软件行为，这条准则要求建立行为模型
必须对描述信息、功能和行为的模型进行分解，用层次的方式展示细节。

## 3.1 需求分析的任务

### 3.1.1 确定对系统的综合需求

虽然功能需求是对软件系统的一项基本需求，但却并不是唯一的需求。通常对软件系统有下述几方面的综合要求。

1、功能需求
这方面的需求指定系统必须提供的服务。通过需求分析应该划分出系统必须完成的所有功能。
2、性能需求
性能需求指定系统必须满足的定时约束或容量约束，通常包括速度（响应时间）、信息量速率、主存容量、磁盘容量、安全性等方面的需求。
3、可靠性和可用性需求
可靠性需求定量地指定系统的可靠性，可用性与可靠性密切相关，它量化了用户可以使用系统的程度。
4、出错处理需求
这类需求说明系统对环境错误应该怎样响应。例如，如果它接收到从另一个系统发来的违反协议格式的消息，应该做什么?注意，上述这类错误并不是由该应用系统本身造成的。
5、接口需求
接口需求描述应用系统与它的环境通信的格式。常见的接口需求有：用户接口需求；硬件接口需求；软件接口需求；通信接口需求。
6、约束
设计约束或实现约束描述在设计或实现应用系统时应遵守的限制条件。常见的约束有：精度；工具和语言约束；设计约束；应该使用的标准；应该使用的硬件平台。
7、逆向需求
逆向需求说明软件系统不应该做什么。理论上有无限多个逆向需求，人们应该仅选取能澄清真实需求且可消除可能发生的误解的那些逆向需求。
8、将来可能提出的要求
应该明确地列出那些虽然不属于当前系统开发范畴，但是据分析将来很可能会提出来的要求。这样做的目的是，在设计过程中对系统将来可能的扩充和修改预做准备，以便一旦确实需要时能比较容易地进行这种扩充和修改。

### 3.1.2 分析系统的数据要求

任何一个软件系统本质上都是信息处理系统，系统必须处理的信息和系统应该产生的信息在很大程度上决定了系统的面貌，对软件设计有深远影响，因此，必须分析系统的数据要求，这是软件需求分析的一个重要任务。
复杂的数据由许多基本的数据元素组成，数据结构表示数据元素之间的逻辑关系。利用数据字典可以全面准确地定义数据，但是数据字典的缺点是不够形象直观。为了提高可理解性，常常利用图形工具辅助描绘数据结构

### 3.1.3 导出系统的逻辑模型

综合上述两项分析的结果可以导出系统的详细的逻辑模型，通常用数据流图、实体-联系图、状态转换图、数据字典和主要的处理算法描述这个逻辑模型。

### 3.1.4 修正系统开发计划

根据在分析过程中获得的对系统的更深入更具体的了解，可以比较准确地估计系统的成本和进度，修正以前制定的开发计划。

## 3.2 与用户沟通获取需求的方法

### 3.2.1 访谈

访谈是最早开始使用的获取用户需求的技术，也是迄今为止仍然广泛使用的需求分析技术。访谈有两种基本形式，分别是正式的和非正式的访谈。
正式访谈时，系统分析员将提出一些事先准备好的具体问题，例如，询问客户公司销售的商品种类、雇用的销售人员数目以及信息反馈时间应该多快等。在非正式访谈中，分析员将提出一些用户可以自由回答的开放性问题，以鼓励被访问人员说出自己的想法，例如，询问用户对目前正在使用的系统有哪些不满意的地方。

在访问用户的过程中使用情景分析技术往往非常有效。所谓情景分析就是对用户将来使用目标系统解决某个具体问题的方法和结果进行分析。
情景分析技术的用处主要体现在下述两个方面。
它能在某种程度上演示目标系统的行为，从而便于用户理解，而且还可能进一步揭示出一些分析员目前还不知道的需求。
由于情景分析较易为用户所理解，使用这种技术能保证用户在需求分析过程中始终扮演一个积极主动的角色。

### 3.2.2 面向数据流自顶向下求精

结构化分析方法就是面向数据流自顶向下逐步求精进行需求分析的方法。通过可行性研究已经得出了目标系统的高层数据流图，需求分析的目标之一就是把数据流和数据存储定义到元素级。
为了达到这个目标，通常从数据流图的输出端着手分析，这是因为系统的基本功能是产生这些输出，输出数据决定了系统必须具有的最基本的组成元素。
数据流图是帮助复查的极好工具，从输入端开始，分析员借助数据流图、数据字典和 IPO 图向用户解释输入数据是怎样一步一步地转变成输出数据的。这些解释集中反映了通过前面的分析工作分析员所获得的对目标系统的认识。

随着分析过程的进展，经过提问和解答的反复循环，分析员越来越深入具体地定义了目标系统，最终得到对系统数据和功能要求的满意了解。

- 图

### 3.2.3 简易的应用规格说明技术

简易的应用规格说明技术是为了解决使用传统的访谈或面向数据流自顶向下求精方法定义需求时，用户处于被动地位而且往往有意无意地与开发者区分“彼此”。由于不能像同一个团队的人那样齐心协力地识别和精化需求，这两种方法的效果有时并不理想。
简易的应用规格说明技术分析需求的典型过程如下:

### 3.2.4 快速建立软件原型

为了快速地构建和修改原型，通常使用下述 3 种方法和工具。

- 第四代技术
- 可重用的软件构件
- 形式化规格说明和原型环境

快速原型就是快速建立起来的旨在演示目标系统主要功能的可运行的程序，快速原型应该具备的特性：
快速原型应该具备的第一个特性是“快速”。
快速原型应该具备的第二个特性是“容易修改”。

## 3.3 分析建模与规格说明

### 3.3.1 分析建模

为了更好地理解复杂事物，人们常常采用建立事物模型的方法。所谓模型，就是为了理解事物而对事物做出的一种抽象，是对事物的一种无歧义的书面描述。通常，模型由一组图形符号和组织这些符号的规则组成。
结构化分析实质上是一种创建模型的活动。为了开发出复杂的软件系统，系统分析员应该从不同角度抽象出目标系统的特性，使用精确的表示方法构造系统的模型，验证模型是否满足用户对目标系统的需求，并在设计过程中逐渐把和实现有关的细节加进模型中，直至最终用程序实现模型。

根据本章开头讲述的结构化分析准则，需求分析过程应该建立 3 种模型，它们分别是数据模型、功能模型和行为模型。
3.4 节将介绍的实体-联系图，描绘数据对象及数据对象之间的关系，是用于建立数据模型的图形。
2.4 节讲过的数据流图，描绘当数据在软件系统中移动时被变换的逻辑过程，指明系统具有的变换数据的功能，因此，数据流图是建立功能模型的基础。
3.6 节将介绍的状态转换图(简称为状态图)，指明了作为外部事件结果的系统行为。为此，状态转换图描绘了系统的各种行为模式(称为“状态”)和在不同状态间转换的方式。状态转换图是行为建模的基础。

### 3.3.2 软件需求规格说明

通过需求分析除了创建分析模型之外，还应该写出软件需求规格说明书，它是需求分析阶段得出的最主要的文档。
通常用自然语言完整、准确、具体地描述系统的数据要求、功能需求、性能需求、可靠性和可用性要求、出错处理需求、接口需求、约束、逆向需求以及将来可能提出的要求。自然语言的规格说明具有容易书写、容易理解的优点，为大多数人所欢迎和采用。
为了消除用自然语言书写的软件需求规格说明书中可能存在的不一致、歧义、含糊、不完整及抽象层次混乱等问题，有些人主张用形式化方法描述用户对软件系统的需求，第 4 章将简要地介绍形式化说明技术。

## 3.4 实体-联系图

为了把用户的数据要求清楚、准确地描述出来，系统分析员通常建立一个概念性的数据模型(也称为信息模型)。
概念性数据模型是一种面向问题的数据模型，是按照用户观点对数据建立的模型。它描述从用户角度看到的数据，反映了用户的现实环境，而且与在软件系统中的实现方法无关。

数据模型中包含 3 种相互关联的信息：
数据对象
数据对象的属性
数据对象彼此间相互连接的关系

### 数据对象

数据对象是对软件必须理解的复合信息的抽象。所谓复合信息是指具有一系列不同性质或属性的事物，仅有单个值的事物（例如，宽度）不是数据对象。
数据对象可以是外部实体（例如，产生或使用信息的任何事物）、事物（例如，报表）、行为（例如，打电话）、事件（例如，响警报）、角色（例如，教师、学生）、单位（例如，会计科）、地点（例如，仓库）或结构（例如，文件）等。总之，可以由一组属性来定义的实体都可以被认为是数据对象。

数据对象彼此间是有关联的，例如，教师“教”课程，学生“学”课程，教或学的关系表示教师和课程或学生和课程之间的一种特定的连接。
数据对象只封装了数据而没有对施加于数据上的操作的引用，这是数据对象与面向对象范型（参见本书第 9 章）中的“类”或“对象”的显著区别。

### 数据对象的属性

属性定义了数据对象的性质。必须把一个或多个属性定义为“标识符”，也就是说，当我们希望找到数据对象的一个实例时，用标识符属性作为“关键字”（通常简称为“键”）。
应该根据对所要解决的问题的理解，来确定特定数据对象的一组合适的属性。

### 数据对象彼此间相互连接的关系

数据对象彼此之间相互连接的方式称为联系，也称为关系。联系可分为以下 3 种类型：
一对一联系（1∶1） ：例如，一个部门有一个经理，而每个经理只在一个部门任职，则部门与经理的联系是一对一的。
一对多联系（1∶N）：例如，某校教师与课程之间存在一对多的联系“教”，即每位教师可以教多门课程，但是每门课程只能由一位教师来教(见图 3.2)。
多对多联系（M∶N）： 例如，图 3.2 表示学生与课程间的联系（“学”）是多对多的，即一个学生可以学多门课程，而每门课程可以有多个学生来学。

联系也可能有属性。例如，学生“学”某门课程所取得的成绩，既不是学生的属性也不是课程的属性。由于“成绩”既依赖于某名特定的学生又依赖于某门特定的课程，所以它是学生与课程之间的联系“学”的属性（见图 3.2）。

### 3.4.4 实体-联系图的符号

通常，使用实体-联系图（entity-relationship diagram）来建立数据模型。可以把实体-联系图简称为 ER 图，相应地可把用 ER 图描绘的数据模型称为 ER 模型。
ER 图中包含了实体（即数据对象）、关系和属性等 3 种基本成分，通常用矩形框代表实体，用连接相关实体的菱形框表示关系，用椭圆形或圆角矩形表示实体（或关系）的属性，并用直线把实体（或关系）与其属性连接起来。例如，图 3.2 是某学校教学管理的 ER 图

人们通常就是用实体、联系和属性这 3 个概念来理解现实问题的，因此，ER 模型比较接近人的习惯思维方式。此外，ER 模型使用简单的图形符号表达系统分析员对问题域的理解，不熟悉计算机技术的用户也能理解它，因此，ER 模型可以作为用户与分析员之间有效的交流工具。

### 数据规范化

软件系统经常使用各种长期保存的信息，这些信息通常以一定方式组织并存储在数据库或文件中，为减少数据冗余，避免出现插入异常或删除异常，简化修改数据的过程，通常需要把数据结构规范化。
通常用“范式（normal forms）”定义消除数据冗余的程度。第一范式（1 NF）数据冗余程度最大，第五范式（5 NF）数据冗余程度最小。

但是，
第一，范式级别越高，存储同样数据就需要分解成更多张表，因此，“存储自身”的过程也就越复杂。
第二，随着范式级别的提高，数据的存储结构与基于问题域的结构间的匹配程度也随之下降，因此，在需求变化时数据的稳定性较差。
第三，范式级别提高则需要访问的表增多，因此性能（速度）将下降。
从实用角度看来，在大多数场合选用第三范式都比较恰当。

通常按照属性间的依赖情况区分规范化的程度。属性间依赖情况满足不同程度要求的为不同范式，满足最低要求的是第一范式，在第一范式中再进一步满足一些要求的为第二范式，其余依此类推。下面给出第一、第二和第三范式的定义：
第一范式每个属性值都必须是原子值，即仅仅是一个简单值而不含内部结构。
第二范式满足第一范式条件，而且每个非关键字属性都由整个关键字决定（而不是由关键字的一部分来决定）。
第三范式符合第二范式的条件，每个非关键字属性都仅由关键字决定，而且一个非关键字属性不能仅仅是对另一个非关键字属性的进一步描述（即一个非关键字属性值不依赖于另一个非关键字属性值）。

### 数据流图

数据流图（DFD）：是一种图形化技术，它描述信息流和数据从输入移动到输出的过程中所经受的变换。

- 符号

附加说明
数据流与程序流程图（第五章）中用箭头表示的控制流有本质不同，在数据流图中应该描绘所有可能的数据流向，而不应该描绘出现某个数据流的条件。
数据存储和数据流都是数据，仅仅所处的状态不同。数据存储是处于静止状态的数据，数据流是处于运动中的数据。
